<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>To-Do List Pro Max</title>
  <style>
    body {
      font-family: "Inter", sans-serif;
      background: #f8f9fa;
      color: #2f3437;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px 20px;
    }

    h1 {
      margin-bottom: 20px;
      font-weight: 600;
      font-size: 28px;
    }

    .todo-container {
      background: #fff;
      border: 1px solid #e5e5e5;
      border-radius: 8px;
      padding: 20px;
      width: 100%;
      max-width: 600px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .progress {
      background: #e9ecef;
      border-radius: 6px;
      overflow: hidden;
      height: 10px;
    }

    .progress-bar {
      height: 100%;
      background: #2f76ff;
      width: 0%;
      transition: width 0.5s ease;
    }

    #motivation {
      font-size: 14px;
      color: #555;
    }

    .controls {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 8px;
    }

    .add-task {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr auto;
      gap: 8px;
    }

    .controls input,
    .controls select,
    .add-task input,
    .add-task select,
    .add-task button {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
    }

    .add-task button {
      border: none;
      background: #2f76ff;
      color: white;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
    }
    .add-task button:hover {
      background: #1d5ce0;
    }

    ul {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    li {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      border: 1px solid #eee;
      border-radius: 6px;
      background: #fafafa;
      cursor: grab;
      transition: background 0.2s;
    }

    li:hover {
      background: #f0f0f0;
    }

    li.dragging {
      opacity: 0.5;
    }

    .task-left {
      display: flex;
      align-items: center;
      gap: 10px;
      flex: 1;
    }

    input[type="checkbox"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
      accent-color: #2f76ff;
    }

    .done {
      text-decoration: line-through;
      color: #999;
    }

    .remove-btn {
      background: transparent;
      border: none;
      color: #d33;
      font-size: 16px;
      cursor: pointer;
    }

    .deadline {
      font-size: 12px;
      padding: 2px 6px;
      border-radius: 4px;
    }

    .deadline.safe { background: #d4edda; color: #155724; }
    .deadline.warning { background: #fff3cd; color: #856404; }
    .deadline.danger { background: #f8d7da; color: #721c24; }

    .tag {
      font-size: 12px;
      padding: 2px 6px;
      background: #e5e5e5;
      border-radius: 4px;
      color: #444;
    }
  </style>
</head>
<body>
  <h1>ðŸ“‹ To-Do List Pro Max</h1>

  <div class="todo-container">
    <div class="progress">
      <div class="progress-bar" id="progress-bar"></div>
    </div>
    <div id="motivation">Belum ada progress, ayo mulai! ðŸš€</div>

    <div class="controls">
      <input type="text" id="search" placeholder="Cari tugas...">
      <select id="filter">
        <option value="all">Semua</option>
        <option value="done">Selesai</option>
        <option value="todo">Belum</option>
      </select>
    </div>

    <div class="add-task">
      <input type="text" id="new-task" placeholder="Tambah tugas baru...">
      <input type="date" id="deadline">
      <select id="category">
        <option value="Umum">Umum</option>
        <option value="Kuliah">Kuliah</option>
        <option value="Kerja">Kerja</option>
        <option value="Pribadi">Pribadi</option>
      </select>
      <button onclick="addTask()">Tambah</button>
    </div>

    <ul id="task-list"></ul>
  </div>

  <script>
    const taskList = document.getElementById('task-list');
    const progressBar = document.getElementById('progress-bar');
    const motivation = document.getElementById('motivation');
    const searchInput = document.getElementById('search');
    const filterSelect = document.getElementById('filter');

    let tasks = JSON.parse(localStorage.getItem('tasks')) || [];

    function saveTasks() {
      localStorage.setItem('tasks', JSON.stringify(tasks));
    }

    function updateProgress() {
      const total = tasks.length;
      const done = tasks.filter(t => t.done).length;
      const percent = total ? (done / total) * 100 : 0;
      progressBar.style.width = percent + "%";

      if (percent === 0) motivation.textContent = "Belum ada progress, ayo mulai! ðŸš€";
      else if (percent < 50) motivation.textContent = "Mantap, lanjut terus! ðŸ’ª";
      else if (percent < 100) motivation.textContent = "Dikit lagi selesai! ðŸ”¥";
      else motivation.textContent = "Semua selesai! ðŸŽ‰";
    }

    function getDeadlineClass(deadline) {
      if (!deadline) return "";
      const today = new Date();
      const d = new Date(deadline);
      const diff = (d - today) / (1000 * 60 * 60 * 24);
      if (diff < 0) return "danger";
      if (diff <= 2) return "warning";
      return "safe";
    }

    function renderTasks() {
      taskList.innerHTML = "";
      const search = searchInput.value.toLowerCase();
      const filter = filterSelect.value;

      tasks.forEach((task, index) => {
        if (filter === "done" && !task.done) return;
        if (filter === "todo" && task.done) return;
        if (search && !task.text.toLowerCase().includes(search)) return;

        const li = document.createElement("li");
        li.draggable = true;

        li.innerHTML = `
          <div class="task-left">
            <input type="checkbox" ${task.done ? "checked" : ""}>
            <span class="${task.done ? "done" : ""}">${task.text}</span>
            ${task.deadline ? `<span class="deadline ${getDeadlineClass(task.deadline)}">${task.deadline}</span>` : ""}
            <span class="tag">${task.category}</span>
          </div>
          <button class="remove-btn">âœ•</button>
        `;

        li.querySelector("input").addEventListener("change", e => {
          tasks[index].done = e.target.checked;
          saveTasks();
          renderTasks();
        });

        li.querySelector(".remove-btn").addEventListener("click", () => {
          tasks.splice(index, 1);
          saveTasks();
          renderTasks();
        });

        li.querySelector("span").addEventListener("dblclick", e => {
          const newText = prompt("Edit tugas:", task.text);
          if (newText) {
            tasks[index].text = newText;
            saveTasks();
            renderTasks();
          }
        });

        li.addEventListener("dragstart", () => {
          li.classList.add("dragging");
        });
        li.addEventListener("dragend", () => {
          li.classList.remove("dragging");
          const newTasks = [];
          taskList.querySelectorAll("li").forEach(el => {
            const text = el.querySelector("span").textContent;
            newTasks.push(tasks.find(t => t.text === text));
          });
          tasks = newTasks;
          saveTasks();
          renderTasks();
        });

        taskList.appendChild(li);
      });

      updateProgress();
    }

    function addTask() {
      const text = document.getElementById("new-task").value.trim();
      const deadline = document.getElementById("deadline").value;
      const category = document.getElementById("category").value;
      if (!text) return;

      tasks.push({ text, done: false, deadline, category });
      saveTasks();
      document.getElementById("new-task").value = "";
      document.getElementById("deadline").value = "";
      renderTasks();
    }

    searchInput.addEventListener("input", renderTasks);
    filterSelect.addEventListener("change", renderTasks);

    renderTasks();
  </script>
</body>
</html>
